{"version":3,"sources":["pureStoreMixin.js"],"names":[],"mappings":";;;;IAAO,SAAS,2BAAM,WAAW;;IAC1B,MAAM,2BAAM,QAAQ;;IAClB,SAAS,WAAQ,aAAa,EAA9B,SAAS;;AAElB,IAAM,cAAc,GAAG,wBAAS,QAAQ,EAAE;;AAEzC,KAAI,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAC7B,MAAM,IAAI,KAAK,CAAC,gCAAgC,CAAC,CAAC;;AAGnD,QAAO;AACN,MAAI,EAAA,gBAAG;;AAEN,OAAI,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,eAAe,GAAG,YAAM,EAAE,CAAC;;;;;;AAM3D,OAAI,CAAC,SAAS,EAAE,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE;AACxC,aAAS,EAAE,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,QAAQ,EAAE,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,eAAe,EAAE,CAAC,CAAC,CAAC;IAC7E;;;AAGD,OAAI,CAAC,MAAM,GAAG,SAAS,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;GACzC;;;;;;;;;AASD,KAAG,EAAA,aAAC,GAAG,EAAE,KAAK,EAAE;AACf,UAAO,IAAI,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;GACrC;;;;;;;;;AASD,KAAG,EAAA,aAAC,GAAG,EAAE;AACR,OAAM,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,CAAE,GAAG,CAAE;OAC/C,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;AACjC,UAAO,MAAM,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK,EAAE,GAAG,MAAM,CAAC;GAC9C;;;;;;;;AAQD,QAAM,EAAA,gBAAC,EAAE,EAAE;AACV,UAAO,IAAI,CAAC,MAAM,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;GAChC;EACD,CAAA;CACD,CAAC;;iBAEa,cAAc","file":"pureStoreMixin.js","sourcesContent":["import Immutable from 'immutable'\nimport Reflux from 'reflux'\nimport { reference } from './reference'\n\nconst PureStoreMixin = function(storeKey) {\n\t// Don't allow dots in the storeKey or it will confuse our path system\n\tif (storeKey.indexOf(\".\") >= 0)\n\t\tthrow new Error(\"Store keys cannot contain dots\");\n\n\n\treturn {\n\t\tinit() {\n\t\t\t// If no initial state is defined set it to an empty object\n\t\t\tif (!this.getInitialState) this.getInitialState = () => {};\n\n\t\t\t// Construct the object we are going to put in the global state.  We are going to convert the object\n\t\t\t// to an Immutable.js structure.  Note that even if there are already Immutable.js structures in the\n\t\t\t// initial state is doesn't matter.  Store it in the global state with a reference cursor under the\n\t\t\t// storeKey.  Note that if the key already exists then do nothing.\n\t\t\tif (!reference().cursor().has(storeKey)) {\n\t\t\t\treference().cursor().set(storeKey, Immutable.fromJS(this.getInitialState()));\n\t\t\t}\n\n\t\t\t// Create a reference cursor to the state\n\t\t\tthis.cursor = reference(storeKey).cursor;\n\t\t},\n\n\t\t/**\n\t\t * A helper method for setting a value on the default cursor.  Equivalent to this.cursor().set(...)\n\t\t *\n\t\t * @param key\n\t\t * @param value\n\t\t * @returns {*}\n\t\t */\n\t\tset(key, value) {\n\t\t\treturn this.cursor().set(key, value);\n\t\t},\n\n\t\t/**\n\t\t * A helper method for getting a value from the default cursor.  It accepts a keypath array\n\t\t * or a single string.\n\t\t *\n\t\t * @param key\n\t\t * @returns {*}\n\t\t */\n\t\tget(key) {\n\t\t\tconst keyPath = Array.isArray(key) ? key : [ key ],\n\t\t\t\t  result = this.cursor(keyPath);\n\t\t\treturn result.deref ? result.deref() : result;\n\t\t},\n\n\t\t/**\n\t\t * A helper method for updating the default cursor.  Equivalent to this.cursor().update(...)\n\t\t *\n\t\t * @param fn\n\t\t * @returns {*}\n\t\t */\n\t\tupdate(fn) {\n\t\t\treturn this.cursor().update(fn);\n\t\t}\n\t}\n};\n\nexport default PureStoreMixin;"],"sourceRoot":"/source/"}