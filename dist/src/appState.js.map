{"version":3,"sources":["appState.js"],"names":[],"mappings":";;;;QASgB,UAAU,GAAV,UAAU;QAMV,QAAQ,GAAR,QAAQ;QAIR,eAAe,GAAf,eAAe;QAIf,KAAK,GAAL,KAAK;;;;;IAvBd,SAAS,2BAAM,WAAW;;IAC1B,SAAS,2BAAM,WAAW;;;AAGjC,IAAI,QAAQ,GAAG,SAAS,CAAC,EAAE,CAAC,CAAC;;;AAG7B,IAAI,UAAU,GAAG,KAAK;IAAE,YAAY,YAAA,CAAC;;AAE9B,SAAS,UAAU,GAAG;AAC5B,SAAQ,GAAG,SAAS,CAAC,EAAE,CAAC,CAAA;AACxB,WAAU,GAAG,KAAK,CAAC;AACnB,aAAY,GAAG,IAAI,CAAC;CACpB;;AAEM,SAAS,QAAQ,GAAG;AAC1B,QAAO,QAAQ,CAAC;CAChB;;AAEM,SAAS,eAAe,GAAG;AACjC,QAAO,QAAQ,CAAC,OAAO,CAAC;CACxB;;AAEM,SAAS,KAAK,CAAC,OAAO,EAAE;AAC9B,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,EAC1B,MAAM,IAAI,KAAK,CAAC,uCAAuC,CAAC,CAAC;;AAE1D,KAAI,UAAU,EAAE,YAAY,GAAG,YAAY,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;AACzE,QAAO,QAAQ,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE,CAAC;CAC1C;;AAED,IAAM,kBAAkB,GAAG;;AAE1B,MAAK,EAAA,iBAAG;AACP,YAAU,GAAG,IAAI,CAAC;AAClB,cAAY,GAAG,SAAS,CAAC,GAAG,EAAE,CAAC;EAC/B;;AAED,IAAG,EAAA,eAAG;AACL,YAAU,GAAG,KAAK,CAAC;AACnB,SAAO,YAAY,CAAC;EACpB;;CAED,CAAC;;QAEO,kBAAkB,GAAlB,kBAAkB;;;AAG3B,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;AAClC,YAAW,CAAC,YAAM;AACjB,cAAY,CAAC,OAAO,CAAC,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,eAAe,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,CAAA;EAC5E,EAAE,IAAI,CAAC,CAAC;AACT,OAAM,CAAC,QAAQ,GAAG,QAAQ,CAAC;AAC3B,OAAM,CAAC,eAAe,GAAG,eAAe,CAAC;AACzC,OAAM,CAAC,KAAK,GAAG,KAAK,CAAC;CACrB","file":"appState.js","sourcesContent":["import immstruct from 'immstruct'\nimport Immutable from 'immutable'\n\n// This is the global application state\nlet appState = immstruct({});\n\n// This is used to track dependencies\nlet isTracking = false, dependencies;\n\nexport function clearState() {\n\tappState = immstruct({})\n\tisTracking = false;\n\tdependencies = null;\n}\n\nexport function getState() {\n\treturn appState;\n}\n\nexport function getCurrentState() {\n\treturn appState.current;\n}\n\nexport function state(keyPath) {\n\tif (!Array.isArray(keyPath))\n\t\tthrow new Error(\"State paths must be given as an array\");\n\n\tif (isTracking) dependencies = dependencies.add(Immutable.List(keyPath));\n\treturn getState().cursor(keyPath).deref();\n}\n\nconst _dependencyTracker = {\n\n\tstart() {\n\t\tisTracking = true;\n\t\tdependencies = Immutable.Set();\n\t},\n\n\tend() {\n\t\tisTracking = false;\n\t\treturn dependencies;\n\t}\n\n};\n\nexport { _dependencyTracker };\n\n// For debugging in a browser\nif (typeof window !== \"undefined\") {\n\tsetInterval(() => {\n\t\tlocalStorage.setItem(\"appState\", JSON.stringify(getCurrentState().toJSON()))\n\t}, 2000);\n\twindow.getState = getState;\n\twindow.getCurrentState = getCurrentState;\n\twindow.state = state;\n}"],"sourceRoot":"/source/"}